---
title: git tips 001 - git 历史重写
date: 2017-03-20 09:30:26
tags:
- git
- 版本管理
- 重写历史
categories:
- 技术
---

问题的起因是 [@tinyfool](http://weibo.com/tinyfool) 在微博上[提问](http://weibo.com/1400229064/EzSFmB7Qg?type=comment)：

> @tinyfool:我在家和办公室用不同的电脑，所以，很多时候git用来同步两边的代码，比如在办公室写了一半，还不应该提交，但是要回家了，只好随便提交了一个名字，到家继续。这种问题，有什么好的解决方案么？我想让git提交历史干净一点 ​​​​

面对 @tinyfool 的需求，变换下描述方式：需要把两个本地库间的工作记录最终合并为一个记录提交到目标分支。

由于是工作在两台不同的机器上的本地库，所以，中间的临时记录，必须有一个提交到远程库的过程。

先说一个概念，特性分支。作为 git的最佳实践之一是： [git-flow](https://danielkummer.github.io/git-flow-cheatsheet/index.zh_CN.html)工作流程。

所有的开发工作，应该工作在特性分支上，开发完成之后，再合并回主开发分支。

由于需求中有一个要求是合并提交记录以使提交历史干净一点。所以，肯定是要使用历史重写。但是 git 历史重写 会导致提交记录污染。

所以，在 git-flow 流程约定的分支分类之上，再增加一类分类：个人分支。即是说，个人分支下的记录，只有提交者自己可以处理，其它人不能动。

加上这样的限制之后，才能确保历史记录的修改不会污染整个团队分支。

git 的哲学和 linux 的哲学一样。很强的扩展性和灵活性，默认用户知道自己做的是什么。

